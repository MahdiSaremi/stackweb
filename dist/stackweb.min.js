(()=>{var A=Object.defineProperty;var j=(i,t)=>{for(var e in t)A(i,e,{get:t[e],enumerable:!0})};var g={};j(g,{gettype:()=>P,is_array:()=>D,is_bool:()=>k,is_double:()=>R,is_float:()=>w,is_null:()=>T,is_object:()=>C,is_string:()=>U,ltrim:()=>H,rtrim:()=>J,strlen:()=>G,substr:()=>F,trim:()=>I});var c=class{constructor(t=void 0){this.value=t}set(t){if(this.value instanceof c)return this.value.set(t);this.value=t}get(){return this.value instanceof c?this.value.get():this.value}},u=class{constructor(t,e,n){this.map=t,this.keys=e,this.high=n}static fromEmpty(){return new u(new Map,[],-1)}static fromArray(t){let e=new Map,n=[];return t.forEach((r,s)=>{e.set(s,r),n.push(s)}),new u(e,n,t.length-1)}static fromMap(t){let e=[],n=-1;for(let r in t.keys())e.push(r),typeof r=="number"&&r>n&&(n=r);return new u(t,e,n)}static fromObject(t){let e=new Map,n=[],r=-1;for(let s in t){let h=+s;isNaN(h)||(s=h),e.set(s,t[s]),n.push(s),typeof s=="number"&&s>r&&(r=s)}return new u(e,n,r)}copy(){return new u(new Map(this.map),[...this.keys],this.high)}push(t){if(this.high++,this.map.has(this.high)){this.map.set(this.high,t);return}this.map.set(this.high,t),this.keys.push(this.high)}pop(){if(this.keys.length==0)return null;let t=this.keys.pop(),e=this.map.get(t);return this.map.delete(t),t===this.high&&this.high--,e}setReal(t,e){if(typeof t=="string"){let n=+t;isNaN(n)||(t=n)}if(typeof t=="number")if(t==this.high+1){this.push(e);return}else t>this.high&&(this.high=t);if(this.map.has(t)){this.map.set(t,e);return}this.map.set(t,e),this.keys.push(t)}set(t,e){if(typeof t=="string"){let r=+t;isNaN(r)||(t=r)}let n=this.map.get(t);n instanceof c&&n.set(e),this.setReal(t,e)}getReal(t){if(typeof t=="string"){let e=+t;isNaN(e)||(t=e)}return this.map.get(t)}get(t){let e=this.getReal(t);return e instanceof c?e.get():e}plus(t){this.high=this.high>t.high?this.high:t.high,t.map.forEach((e,n)=>{this.map.has(n)||(this.map.set(n,e),this.keys.push(n))})}replace(t){this.high=this.high>t.high?this.high:t.high,t.map.forEach((e,n)=>{this.set(n,e)})}merge(t){this.high=this.high>t.high?this.high:t.high,t.map.forEach((e,n)=>{isNaN(+n)?this.set(n,e):this.push(e)})}count(){return this.keys.length}ref(t){let e=this.get(t),n=new c(e);return this.set(t,n),n}};function P(i){let t=i.next("value");return i.end(),o.getType(t)}function w(i){let t=i.next("value");return i.end(),o.getType(t)==="double"}var R=w;function k(i){let t=i.next("value");return i.end(),o.getType(t)==="boolean"}function T(i){let t=i.next("value");return i.end(),o.getType(t)==="null"}function C(i){let t=i.next("value");return i.end(),o.getType(t)==="object"}function U(i){let t=i.next("value");return i.end(),o.getType(t)==="string"}function D(i){let t=i.next("value");return i.end(),t instanceof u}function G(i){let t=o.toString(i.next("string"));return i.end(),a.defaultString.len(t)}function F(i){let t=o.toString(i.next("string")),e=o.toNumber(i.next("offset")),n=i.next("length",null);return i.end(),n!==null&&(n=o.toNumber(n)),a.defaultString.substr(t,e,n)}function I(i){let t=o.toString(i.next("string")),e=o.toString(i.next("characters",` 
\r	\v\0`));return i.end(),a.defaultString.trim(t,e)}function H(i){let t=o.toString(i.next("string")),e=o.toString(i.next("characters",` 
\r	\v\0`));return i.end(),a.defaultString.ltrim(t,e)}function J(i){let t=o.toString(i.next("string")),e=o.toString(i.next("characters",` 
\r	\v\0`));return i.end(),a.defaultString.rtrim(t,e)}var f=class{constructor(t,e){this.encoder=t,this.decoder=e}standardSubParams(t,e,n){for(;t<0;)t=n+t;if(t>=n)return[0,0];if(e!==null){if(e<0)return[0,0];let r=t+e;r>=n&&(e-=r-n)}return[t,e]}len(t){let e=this.encoder.encode(t),n=0;for(let r=0;r<e.length;r++)n+=this.decoder.decode(e.slice(r,r+1)).length;return n}substr(t,e,n){let r=this.encoder.encode(t);[e,n]=this.standardSubParams(e,n,r.length);let s;return n===null?s=r.slice(e,r.length):s=r.slice(e,e+n),this.decoder.decode(s)}split(t){let e=this.encoder.encode(t),n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=this.decoder.decode(e.slice(r,r+1));return n}splitCharsToString(t){let e=new Uint8Array(t.length);for(let n in t)e[n]=this.encoder.encode(t[n])[0];return this.decoder.decode(e)}splitToString(t){let e=new Array(t.length),n=0;for(let h in t)e[h]=this.encoder.encode(t[h]),n+=e[h].length;let r=new Uint8Array(n),s=0;for(let h in e)for(let d in e[h])r[s++]=e[h][d];return this.decoder.decode(r)}trim(t,e){let n=this.encoder.encode(t),r=this.encoder.encode(e),s,h;for(s=0;s<n.length&&!(r.indexOf(n[s])<0);s++);for(h=n.length-1;h>s&&!(r.indexOf(n[h])<0);h--);return this.decoder.decode(n.slice(s,h+1))}ltrim(t,e){let n=this.encoder.encode(t),r=this.encoder.encode(e),s;for(s=0;s<n.length&&!(r.indexOf(n[s])<0);s++);return this.decoder.decode(n.slice(s,n.length))}rtrim(t,e){let n=this.encoder.encode(t),r=this.encoder.encode(e),s;for(s=n.length-1;s>=0&&!(r.indexOf(n[s])<0);s--);return this.decoder.decode(n.slice(0,s+1))}};var p=class{constructor(t=void 0,e=void 0,n={}){this.$static=t,this.$this=e,this.vars=n,this.v=new Proxy(this,{get(r,s,h){if(s=="this")return r.$this;let d=r.vars[s];return d instanceof c?d.get():d},set(r,s,h,d){return r.vars[s]instanceof c?(r.vars[s].set(h),!0):(r.vars[s]=h,!0)},has(r,s){return r.vars[s]!==void 0}})}ref(t){t=o.toString(t);let e=this.vars[t];return e instanceof c?e:this.vars[t]=new c(e)}real(t){return t=o.toString(t),this.vars[t]}};var o=class{static opAdd(t,e){if(t instanceof u){let n=t.copy();return n.plus(this.toArray(e)),n}return this.toNumber(t)+this.toNumber(e)}static opSub(t,e){return this.toNumber(t)-this.toNumber(e)}static opMul(t,e){return this.toNumber(t)*this.toNumber(e)}static opDiv(t,e){return this.toNumber(t)/this.toNumber(e)}static opDot(t,e){return this.toString(t)+this.toString(e)}static getType(t){switch(t instanceof c&&(t=t.get()),typeof t){case"undefined":return"null";case"number":return"double";case"bigint":return"integer";case"boolean":return"boolean";case"string":return"string";case"object":return t===null?"null":t instanceof u||t instanceof Array?"array":"object";case"function":case"symbol":default:return"object"}}static toNumber(t){switch(t instanceof c&&(t=t.get()),typeof t){case"bigint":case"number":return t;case"boolean":return t?1:0;case"undefined":return 0;case"object":return t===null?1:0;case"string":let n=+t;return isNaN(n)?0:n;default:return 1}}static toString(t){switch(t instanceof c&&(t=t.get()),typeof t){case"bigint":case"number":return""+t;case"string":return t;case"boolean":return t?"1":"";case"undefined":return"";case"object":return t===null?"":t instanceof u?"Array":"object";default:return"object"}}static toBool(t){switch(t instanceof c&&(t=t.get()),typeof t){case"bigint":case"number":return t!=0;case"string":return t!=""&&t!="0";case"boolean":return t;case"undefined":return!1;case"object":return t instanceof u?t.count()>0:t!==null;default:return!0}}static isNumeric(t){t instanceof c&&(t=t.get());let e=typeof t;return e=="bigint"||e=="number"?!0:e!="string"?!1:!isNaN(t)&&!isNaN(+t)}static toStringOrNumber(t){return typeof t=="number"?t:this.toString(t)}static toArray(t){t instanceof c&&(t=t.get());let e=typeof t;if(t instanceof u)return t;switch(e){case"string":return u.fromArray(new Array(...t));default:return u.fromEmpty()}}static callFunction(t,e){t=t.toLowerCase();let n=a.functions[t];if(n)return this.callJsFunction(n,e);throw new Error(`Function [${t}] is not exists`)}static callJsFunction(t,e){return t(e)}static getOffset(t,e){switch(e=o.toStringOrNumber(e),typeof t){case"string":return a.defaultString.substr(t,o.toNumber(e),1);case"object":if(t instanceof u)return t.get(e);break}return null}static setOffset(t,e,n){switch(e=o.toStringOrNumber(e),typeof t){case"object":if(t instanceof u){t.set(e,n);return}break}return null}static pushOffset(t,e){switch(typeof t){case"object":if(t instanceof u){t.push(e);return}break}return null}static getArrayAccess(t,e){if(e!==null&&(e=o.toStringOrNumber(e)),t instanceof p){e===null&&(e="");let n=t.real(e);return n==null&&(t.v[e]=n=u.fromEmpty()),n}else if(t instanceof u){let n;return e===null?t.push(n=u.fromEmpty()):(n=t.getReal(e),n==null&&t.set(e,n=u.fromEmpty())),n}return null}},L={},O=new TextEncoder,M=new TextDecoder,B=new f(O,M),a={functions:g,textEncoder:O,textDecoder:M,defaultString:B};window.P=L;window.PHPUtils=o;window.Test=()=>{let i=new p,t=i.v;o.setOffset(o.getArrayAccess(o.getArrayAccess(i,"a"),null),0,"Hi"),console.log(t.a)};var l=class{constructor(){this.isMounted=!1;this.isStatic=!1}mount(t,e,n){this.parent=t,this.parentE=e,this.el=n,this.isMounted=!1,this.onMount(),this.isMounted=!0}unmount(){this.onUnmount(),this.isMounted=!1}morph(t){this.isStatic||this.onMorph(t)}static(){return this.isStatic=!0,this}insertNode(t){if(this.parentE.isMounted){let e=this.parent.resolveNextNodeOf(this);e?this.parent.el.insertBefore(t,e):this.parent.el.appendChild(t)}else this.parent.el.appendChild(t)}},m=class extends l{constructor(e){super();this.source=e}onMount(){this.source.mount(this,this,this.el)}onUnmount(){this.source.unmount()}onMorph(e){this.source.morph(e.source)}resolveRelativeNodes(){return this.source.resolveRelativeNodes()}resolveNextNodeOf(e){}},b=class extends l{constructor(e){super();this.source=e}onMount(){for(let e in this.source)this.source[e].mount(this,this.parentE,this.el)}onUnmount(){for(let e in this.source)this.source[e].unmount()}onMorph(e){for(let n in this.source)this.source[n].morph(e.source[n])}resolveRelativeNodes(){if(this.source.length==0)return[void 0,void 0];if(this.source.length==1)return this.source[0].resolveRelativeNodes();{let e,n,r;for(r=0;r<this.source.length;r++){let s=this.source[r].resolveRelativeNodes();if(s[0]||s[1]){e=s[0]??s[1];break}}for(r=this.source.length-1;r>=0;r--){let s=this.source[r].resolveRelativeNodes();if(s[0]||s[1]){n=s[1]??s[0];break}}return[e,n]}}resolveNextNodeOf(e){let n=this.source.indexOf(e);for(let r=n+1;r<this.source.length;r++){let s=this.source[r].resolveRelativeNodes();if(s[0]||s[1])return s[0]??s[1]}if(this.parent)return this.parent.resolveNextNodeOf(this)}},y=class extends l{constructor(e){super();this.source=e,this.filterSource()}filterSource(){for(let e in this.source.attrs){let n=this.source.attrs[e];(n==null||n===!1)&&delete this.source.attrs[e]}}onMount(){this.el=document.createElement(this.source.name),this.insertNode(this.el),this.source.slot.mount(this,this,this.el);for(let e in this.source.attrs)this._setAttribute(e,this.source.attrs[e],void 0)}onUnmount(){this.el.remove(),this.el=void 0}onMorph(e){this.source.slot.morph(e.source.slot);let n=e.source.attrs;for(let r in this.source.attrs)n[r]===void 0?(this._removeAttribute(r,this.source.attrs[r]),delete this.source.attrs[r]):(this._setAttribute(r,n[r],this.source.attrs[r]),this.source.attrs[r]=n[r]),delete n[r];for(let r in n)this._setAttribute(r,n[r],void 0),this.source.attrs[r]=n[r]}_setAttribute(e,n,r){if(e.indexOf("on")===0){let s=e.substring(2).toLowerCase();r!==void 0&&this.el.removeEventListener(s,r),this.el.addEventListener(s,n);return}n===!0&&(n=""),this.el.setAttribute(e,n)}_removeAttribute(e,n){if(e.indexOf("on")===0){let r=e.substring(2).toLowerCase();this.el.removeEventListener(r,n);return}this.el.removeAttribute(e)}resolveRelativeNodes(){return[this.el,this.el]}resolveNextNodeOf(e){}},N=class extends l{constructor(e){super();this.value=e}onMount(){this.node=document.createTextNode(this.value),this.insertNode(this.node)}onUnmount(){this.el.removeChild(this.node),this.node=void 0}onMorph(e){this.value=e.value,this.node.textContent=this.value}resolveRelativeNodes(){return[this.node,this.node]}resolveNextNodeOf(e){}},x=class extends l{onMount(){this.node=document.createTextNode("Hello World ("+Math.floor(Math.random()*100)+")"),this.insertNode(this.node)}onUnmount(){this.el.removeChild(this.node),this.node=void 0}onMorph(e){this.node.textContent="Hello World ("+Math.floor(Math.random()*100)+")"}resolveRelativeNodes(){return[this.node,this.node]}resolveNextNodeOf(e){}},v=class{constructor(t){this.morphMode=0;this.source=t}morphType(t){return this.morphMode=t,this}},S=class extends l{constructor(e,n,r){super();this.states={};this.changed=!1;this.component=e,this.props=n,this.slots=r}onMount(){for(let e in this.component.source.slots)this.slots[e]===void 0&&(this.slots[e]=()=>this.component.source.slots[e](this));this.states=this.component.source.states(this),this.content=this.component.source.render(this),this.content.mount(this,this.parentE,this.el)}onUnmount(){this.content.unmount()}reset(){this.states=this.component.source.states(this)}refresh(){let e=this.component.source.render(this);this.content.morph(e),this.changed=!1}onMorph(e){if(this.component.morphMode==0){let n=!1;JSON.stringify(this.props)!==JSON.stringify(e.props)&&(n=!0,this.props=e.props),n&&this.content.morph(e.component.source.render(this))}this.component.morphMode==1&&this.content.morph(e.component.source.render(this))}getState(e){return this.states[e]}setState(e,n){this.states[e]=n,this.changed=!0}track(e){e(),this.changed&&this.refresh()}getSlot(e=""){return this.slots[e]}getProp(e){return this.props[e]}getApiResult(e){return null}get(e){if(this.states[e]!==void 0)return this.states[e];if(this.props[e]!==void 0)return this.props[e];if(this.slots[e]!==void 0)return this.slots[e]}resolveRelativeNodes(){return this.content.resolveRelativeNodes()}resolveNextNodeOf(e){return this.parent.resolveNextNodeOf(this)}},E=class extends l{constructor(e,n){super();this.source=n,this.condition=e}onMount(){this.condition&&this.source.mount(this,this.parentE,this.el)}onUnmount(){this.condition&&this.source.unmount()}onMorph(e){let n=e.condition;n!=this.condition&&(n?this.source.mount(this,this.parentE,this.el):this.source.onUnmount(),this.condition=n)}resolveRelativeNodes(){return this.condition?this.source.resolveRelativeNodes():[void 0,void 0]}resolveNextNodeOf(e){return this.parent.resolveNextNodeOf(this)}};window.StackWeb={Entity:l,Root:m,Group:b,Dom:y,Text:N,HelloWorld:x,Component:v,Invoke:S,If:E};})();
//# sourceMappingURL=stackweb.min.js.map
