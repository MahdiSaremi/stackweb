(()=>{var E=Object.defineProperty;var O=(r,t)=>{for(var e in t)E(r,e,{get:t[e],enumerable:!0})};var d={};O(d,{gettype:()=>j,is_bool:()=>R,is_double:()=>w,is_float:()=>M,is_null:()=>S,is_object:()=>P,is_string:()=>C});function j(r){let t=r.next("value");return r.end(),u.getType(t)}function M(r){let t=r.next("value");return r.end(),u.getType(t)==="double"}var w=M;function R(r){let t=r.next("value");return r.end(),u.getType(t)==="boolean"}function S(r){let t=r.next("value");return r.end(),u.getType(t)==="null"}function P(r){let t=r.next("value");return r.end(),u.getType(t)==="object"}function C(r){let t=r.next("value");return r.end(),u.getType(t)==="string"}var o=class{constructor(t=void 0){this.value=t}set(t){if(this.value instanceof o)return this.value.set(t);this.value=t}get(){return this.value instanceof o?this.value.get():this.value}},a=class{constructor(t,e,s){this.map=t,this.keys=e,this.high=s}static fromEmpty(){return new a(new Map,[],-1)}static fromArray(t){let e=new Map,s=[];return t.forEach((i,n)=>{e.set(n,i),s.push(n)}),new a(e,s,t.length-1)}static fromMap(t){let e=[],s=-1;for(let i in t.keys())e.push(i),typeof i=="number"&&i>s&&(s=i);return new a(t,e,s)}static fromObject(t){let e=new Map,s=[],i=-1;for(let n in t){let c=+n;isNaN(c)||(n=c),e.set(n,t[n]),s.push(n),typeof n=="number"&&n>i&&(i=n)}return new a(e,s,i)}push(t){if(this.high++,this.map.has(this.high)){this.map.set(this.high,t);return}this.map.set(this.high,t),this.keys.push(this.high)}pop(){if(this.keys.length==0)return null;let t=this.keys.pop(),e=this.map.get(t);return this.map.delete(t),t===this.high&&this.high--,e}set(t,e){if(typeof t=="string"){let s=+t;isNaN(s)||(t=s)}if(typeof t=="number")if(t==this.high+1){this.push(e);return}else t>this.high&&(this.high=t);if(this.map.has(t)){this.map.set(t,e);return}this.map.set(t,e),this.keys.push(t)}get(t){if(typeof t=="string"){let e=+t;isNaN(e)||(t=e)}return this.map.get(t)}plus(t){this.high=this.high>t.high?this.high:t.high,t.map.forEach((e,s)=>{this.map.has(s)||(this.map.set(s,e),this.keys.push(s))})}replace(t){this.high=this.high>t.high?this.high:t.high,t.map.forEach((e,s)=>{this.set(s,e)})}merge(t){this.high=this.high>t.high?this.high:t.high,t.map.forEach((e,s)=>{this.set(s,e)})}};var p=class{constructor(t=void 0,e=void 0,s={}){this.$static=t,this.$this=e,this.vars=s,this.v=new Proxy(this,{get(i,n,c){if(n=="this")return i.$this;let l=i.vars[n];return l instanceof o?l.get():l},set(i,n,c,l){return i.vars[n]instanceof o?(i.vars[n].set(c),!0):(i.vars[n]=c,!0)},has(i,n){return i.vars[n]!==void 0}})}ref(t){let e=this.vars[t];return e instanceof o?e:this.vars[t]=new o(e)}};var u=class{static opAdd(t,e){return this.toNumber(t)+this.toNumber(e)}static opSub(t,e){return this.toNumber(t)-this.toNumber(e)}static opMul(t,e){return this.toNumber(t)*this.toNumber(e)}static opDiv(t,e){return this.toNumber(t)/this.toNumber(e)}static opDot(t,e){return this.toString(t)+this.toString(e)}static getType(t){switch(typeof t){case"undefined":return"null";case"number":return"double";case"bigint":return"integer";case"boolean":return"boolean";case"string":return"string";case"object":return t===null?"null":t instanceof Array?"array":"object";case"function":case"symbol":default:return"object"}}static toNumber(t){switch(typeof t){case"bigint":case"number":return t;case"boolean":return t?1:0;case"undefined":return 0;case"object":return t===null?1:0;case"string":let s=+t;return isNaN(s)?0:s;default:return 1}}static toString(t){switch(typeof t){case"bigint":case"number":return""+t;case"string":return t;case"boolean":return t?"1":"";case"undefined":return"";case"object":return t===null?"":"object";default:return"object"}}static toBool(t){switch(typeof t){case"bigint":case"number":return t!=0;case"string":return t!=""&&t!="0";case"boolean":return t;case"undefined":return!1;case"object":return t!==null;default:return!0}}static isNumeric(t){let e=typeof t;return e=="bigint"||e=="number"?!0:e!="string"?!1:!isNaN(t)&&!isNaN(+t)}},A={functions:d};window.P=A;window.Test=()=>{let r=new p,t=r.v;t.a=a.fromObject({0:1,1:2,2:3}),t.a.set("4",5),t.a.push(5),console.log(t.a)};var h=class{constructor(){this.isMounted=!1;this.isStatic=!1}mount(t,e,s){this.parent=t,this.parentE=e,this.el=s,this.isMounted=!1,this.onMount(),this.isMounted=!0}unmount(){this.onUnmount(),this.isMounted=!1}morph(t){this.isStatic||this.onMorph(t)}static(){return this.isStatic=!0,this}insertNode(t){if(this.parentE.isMounted){let e=this.parent.resolveNextNodeOf(this);e?this.parent.el.insertBefore(t,e):this.parent.el.appendChild(t)}else this.parent.el.appendChild(t)}},f=class extends h{constructor(e){super();this.source=e}onMount(){this.source.mount(this,this,this.el)}onUnmount(){this.source.unmount()}onMorph(e){this.source.morph(e.source)}resolveRelativeNodes(){return this.source.resolveRelativeNodes()}resolveNextNodeOf(e){}},m=class extends h{constructor(e){super();this.source=e}onMount(){for(let e in this.source)this.source[e].mount(this,this.parentE,this.el)}onUnmount(){for(let e in this.source)this.source[e].unmount()}onMorph(e){for(let s in this.source)this.source[s].morph(e.source[s])}resolveRelativeNodes(){if(this.source.length==0)return[void 0,void 0];if(this.source.length==1)return this.source[0].resolveRelativeNodes();{let e,s,i;for(i=0;i<this.source.length;i++){let n=this.source[i].resolveRelativeNodes();if(n[0]||n[1]){e=n[0]??n[1];break}}for(i=this.source.length-1;i>=0;i--){let n=this.source[i].resolveRelativeNodes();if(n[0]||n[1]){s=n[1]??n[0];break}}return[e,s]}}resolveNextNodeOf(e){let s=this.source.indexOf(e);for(let i=s+1;i<this.source.length;i++){let n=this.source[i].resolveRelativeNodes();if(n[0]||n[1])return n[0]??n[1]}if(this.parent)return this.parent.resolveNextNodeOf(this)}},g=class extends h{constructor(e){super();this.source=e}onMount(){this.el=document.createElement(this.source.name),this.insertNode(this.el),this.source.slot.mount(this,this,this.el)}onUnmount(){this.el.remove(),this.el=void 0}onMorph(e){this.source.slot.morph(e.source.slot)}resolveRelativeNodes(){return[this.el,this.el]}resolveNextNodeOf(e){}},b=class extends h{constructor(e){super();this.value=e}onMount(){this.node=document.createTextNode(this.value),this.insertNode(this.node)}onUnmount(){this.el.removeChild(this.node),this.node=void 0}onMorph(e){this.value=e.value,this.node.textContent=this.value}resolveRelativeNodes(){return[this.node,this.node]}resolveNextNodeOf(e){}},N=class extends h{onMount(){this.node=document.createTextNode("Hello World ("+Math.floor(Math.random()*100)+")"),this.insertNode(this.node)}onUnmount(){this.el.removeChild(this.node),this.node=void 0}onMorph(e){this.node.textContent="Hello World ("+Math.floor(Math.random()*100)+")"}resolveRelativeNodes(){return[this.node,this.node]}resolveNextNodeOf(e){}},y=class{constructor(t){this.morphMode=0;this.source=t}morphType(t){return this.morphMode=t,this}},v=class extends h{constructor(e,s,i){super();this.states={};this.changed=!1;this.component=e,this.props=s,this.slots=i}onMount(){for(let e in this.component.source.slots)this.slots[e]===void 0&&(this.slots[e]=()=>this.component.source.slots[e](this));this.states=this.component.source.states(this),this.content=this.component.source.render(this),this.content.mount(this,this.parentE,this.el)}onUnmount(){this.content.unmount()}reset(){this.states=this.component.source.states(this)}refresh(){let e=this.component.source.render(this);this.content.morph(e),this.changed=!1}onMorph(e){if(this.component.morphMode==0){let s=!1;JSON.stringify(this.props)!==JSON.stringify(e.props)&&(s=!0,this.props=e.props),s&&this.content.morph(e.component.source.render(this))}this.component.morphMode==1&&this.content.morph(e.component.source.render(this))}getState(e){return this.states[e]}setState(e,s){this.states[e]=s,this.changed=!0}track(e){e(),this.changed&&this.refresh()}getSlot(e=""){return this.slots[e]}getProp(e){return this.props[e]}getApiResult(e){return null}get(e){if(this.states[e]!==void 0)return this.states[e];if(this.props[e]!==void 0)return this.props[e];if(this.slots[e]!==void 0)return this.slots[e]}resolveRelativeNodes(){return this.content.resolveRelativeNodes()}resolveNextNodeOf(e){return this.parent.resolveNextNodeOf(this)}},x=class extends h{constructor(e,s){super();this.source=s,this.condition=e}onMount(){this.condition&&this.source.mount(this,this.parentE,this.el)}onUnmount(){this.condition&&this.source.unmount()}onMorph(e){let s=e.condition;s!=this.condition&&(s?this.source.mount(this,this.parentE,this.el):this.source.onUnmount(),this.condition=s)}resolveRelativeNodes(){return this.condition?this.source.resolveRelativeNodes():[void 0,void 0]}resolveNextNodeOf(e){return this.parent.resolveNextNodeOf(this)}};window.StackWeb={Entity:h,Root:f,Group:m,Dom:g,Text:b,HelloWorld:N,Component:y,Invoke:v,If:x};})();
//# sourceMappingURL=stackweb.min.js.map
